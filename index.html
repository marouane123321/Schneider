<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>عرض مشروع — قالب شبيه itch.io</title>
  <style>
    /* نفس التنسيقات السابقة */
  </style>
</head>
<body>
  <div class="container">
    <!-- نفس الهيكل السابق -->
    <div style="margin-top:20px" class="card">
      <h3>رفع أو تعديل الملف/الصور</h3>
      <input type="file" id="fileUpload" multiple>
      <button class="btn" id="uploadBtn">رفع الملفات</button>
    </div>
  </div>

  <div class="lightbox" id="lightbox"><img src="" alt="" id="lightboxImg"></div>

  <script>
    const config = {
      title: 'مشروعي التجريبي',
      description: 'لعبة تجريبية مبنية بـ Godot. لفك الضغط افتح project.rar ثم شغّل الملف داخل مجلد dist.',
      cover: 'cover.jpg',
      avatar: 'avatar.jpg',
      rarLink: 'project.rar',
      screenshots: ['shot1.jpg','shot2.jpg','shot3.jpg','shot4.jpg']
    }
    
    function renderPage() {
      document.getElementById('title').innerText = config.title
      document.getElementById('description').innerText = config.description
      document.querySelector('.cover').src = config.cover
      document.querySelector('.avatar').src = config.avatar
      document.getElementById('fileName').innerText = config.rarLink
      document.getElementById('downloadBtn').onclick = () => downloadFile(config.rarLink)
      document.getElementById('dl2').onclick = () => downloadFile(config.rarLink)
      document.getElementById('visitBtn').onclick = () => window.open('#','_blank')
      const gallery = document.getElementById('gallery')
      gallery.innerHTML = ''
      config.screenshots.forEach(src=>{
        const img = document.createElement('img')
        img.className = 'thumb'
        img.src = src
        img.alt = 'لقطة'
        img.onclick = ()=> openLightbox(src)
        gallery.appendChild(img)
      })
    }

    function openLightbox(src){
      document.getElementById('lightboxImg').src = src
      document.getElementById('lightbox').style.display='flex'
    }
    document.getElementById('lightbox').onclick = ()=> document.getElementById('lightbox').style.display='none'

    function downloadFile(url) {
      const a = document.createElement('a')
      a.href = url
      a.download = url.split('/').pop()
      a.click()
    }

    document.getElementById('uploadBtn').onclick = () => {
      const files = document.getElementById('fileUpload').files
      if (!files.length) return alert('اختر ملفًا أولاً')
      for (let file of files) {
        const url = URL.createObjectURL(file)
        if (file.name.endsWith('.rar')) {
          config.rarLink = url
          document.getElementById('fileName').innerText = file.name
        } else if (file.type.startsWith('image/')) {
          config.screenshots.push(url)
        }
      }
      renderPage()
    }

    renderPage()
  </script>
</body>
</html>
